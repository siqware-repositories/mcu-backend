(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"0WBr":function(t,e,n){"use strict";n.r(e);var a=n("o0o1"),i=n.n(a),r=n("ksP6"),s=n.n(r),o=(n("Hj/Q"),{name:"addGallery",components:{ImageUpload:n("xsPV").a,vueDropzone:s.a},props:["is_popup"],data:function(){return{gallery:{thumb:[],title:"",images:[]},upload_url:route("file.upload.original"),galleryOptions:{url:route("file.upload.original"),thumbnailWidth:150,thumbnailHeight:150,addRemoveLinks:!0,dictDefaultMessage:"ដាក់អាល់ប៊ុមរូបភាព"},thumbnailOptions:{url:route("file.upload.original"),maxFiles:1,addRemoveLinks:!0,dictDefaultMessage:"សូមដាក់រូប Thumbnail",thumbnailWidth:150,thumbnailHeight:150}}},computed:{placeholder:function(){return this.$store.getters.getAppUrl+"images/placeholder/placeholder.png"},popupSync:{get:function(){return this.is_popup},set:function(t){this.$emit("update-is_popup",t)}}},methods:{setThumb:function(t){this.gallery.thumb=t},successUploadGallery:function(t,e){this.gallery.images.unshift(e)},successUploadThumb:function(t,e){this.gallery.thumb.unshift(e)},removeGallery:function(t){var e=this.gallery.images.findIndex((function(e){return e.path===JSON.parse(t.xhr.response).path}));this.gallery.images.splice(e,1)},removeThumb:function(t){var e=this.gallery.thumb.findIndex((function(e){return e.path===JSON.parse(t.xhr.response).path}));this.gallery.thumb.splice(e,1)},storeGallery:function(){var t=this,e=this;this.$validator.validateAll().then((function(n){n&&e.gallery.thumb.length&&e.gallery.images.length?(e.$vs.loading(),t.$store.dispatch("storeGallery",e.gallery).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField(),e.$refs.thumb.removeAllFiles(!0),e.$refs.gallery.removeAllFiles(!0)):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.gallery={thumb:[],title:"",images:[]}},removeGallert:function(){}}}),l=n("KHd+"),c=Object(l.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("vs-popup",{attrs:{title:"បន្ថែម",active:t.popupSync},on:{"update:active":function(e){t.popupSync=e}}},[n("div",{staticClass:"vx-row mb-2"},[n("div",{staticClass:"vx-col w-full"},[n("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{name:"title","label-placeholder":"ចំណងជើង"},model:{value:t.gallery.title,callback:function(e){t.$set(t.gallery,"title",e)},expression:"gallery.title"}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("title"),expression:"errors.has('title')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("title")))])],1),t._v(" "),n("div",{staticClass:"vx-col w-full mt-2"},[n("vue-dropzone",{ref:"thumb",staticClass:"max-content p-1",attrs:{duplicateCheck:!0,id:"thumbnail",options:t.thumbnailOptions},on:{"vdropzone-removed-file":t.removeThumb,"vdropzone-success":t.successUploadThumb}})],1),t._v(" "),n("vs-divider"),t._v(" "),n("div",{staticClass:"vx-col w-full"},[n("vue-dropzone",{ref:"gallery",staticClass:"p-1",attrs:{duplicateCheck:!0,id:"gallery",options:t.galleryOptions},on:{"vdropzone-removed-file":t.removeGallery,"vdropzone-success":t.successUploadGallery}})],1)],1),t._v(" "),n("vs-divider"),t._v(" "),n("div",{staticClass:"vx-row"},[n("div",{staticClass:"vx-col w-full"},[n("vs-button",{staticClass:"mr-3 mb-2",attrs:{type:"relief"},on:{click:function(e){return e.preventDefault(),t.storeGallery(e)}}},[t._v("\n                រក្សាទុក\n            ")])],1)])],1)}),[],!1,null,"798c3900",null).exports;function u(t,e,n,a,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(a,i)}var p,d,v={name:"editGallery",props:["is_popup"],data:function(){return{gallery:{id:null,title:""}}},computed:{popupSync:{get:function(){return this.is_popup},set:function(t){this.$emit("update-is_popup",t)}}},methods:{editGallery:function(t){var e=this;e.$store.dispatch("editGallery",t).then((function(t){e.gallery=t}))},updateGallery:function(){var t=this,e=this;this.$validator.validateAll().then((function(n){n?(e.$vs.loading(),t.$store.dispatch("updateGallery",e.gallery).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField(),e.fetchGallery()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.gallery={title:""}},fetchGallery:(p=i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("fetchGallery");case 2:case"end":return t.stop()}}),t,this)})),d=function(){var t=this,e=arguments;return new Promise((function(n,a){var i=p.apply(t,e);function r(t){u(i,n,a,r,s,"next",t)}function s(t){u(i,n,a,r,s,"throw",t)}r(void 0)}))},function(){return d.apply(this,arguments)})}};function h(t,e,n,a,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(a,i)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(a,i){var r=t.apply(e,n);function s(t){h(r,a,i,s,o,"next",t)}function o(t){h(r,a,i,s,o,"throw",t)}s(void 0)}))}}var m,y,g={name:"Gallery",components:{EditGallery:Object(l.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("vs-popup",{attrs:{title:"កែប្រែ",active:t.popupSync},on:{"update:active":function(e){t.popupSync=e}}},[n("div",{staticClass:"vx-row mb-2"},[n("div",{staticClass:"vx-col w-full"},[n("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{name:"title","label-placeholder":"ចំណងជើង"},model:{value:t.gallery.title,callback:function(e){t.$set(t.gallery,"title",e)},expression:"gallery.title"}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("title"),expression:"errors.has('title')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("title")))])],1)]),t._v(" "),n("vs-divider"),t._v(" "),n("div",{staticClass:"vx-row"},[n("div",{staticClass:"vx-col w-full"},[n("vs-button",{staticClass:"mr-3 mb-2",attrs:{type:"relief"},on:{click:function(e){return e.preventDefault(),t.updateGallery(e)}}},[t._v("\n                កែប្រែ\n            ")])],1)])],1)}),[],!1,null,"72bc2ea2",null).exports,AddGallery:c},data:function(){return{is_popup:!1,is_popup_edit:!1,selected:[],tableList:["vs-th: Component","vs-tr: Component","vs-td: Component","thread: Slot","tbody: Slot","header: Slot"]}},computed:{all_galleries:function(){return this.$store.getters.all_galleries}},created:(y=f(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchGallery();case 2:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)}),methods:{syncPopup:function(t){this.is_popup=t},syncPopupEdit:function(t){this.is_popup_edit=t,this.selected=[]},fetchGallery:function(){var t=f(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("fetchGallery");case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),destroyGallery:(m=f(i.a.mark((function t(){var e,n;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this).$vs.loading(),n=e.selected.map(function(){var t=f(i.a.mark((function t(n){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("destroyGallery",n.id);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=5,Promise.all(n).then((function(){e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.selected=[],e.$vs.loading.close()}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})}},_=(n("fBHZ"),Object(l.a)(g,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("vx-card",{attrs:{"no-shadow":""}},[n("div",{staticClass:"flex btn-group"},[n("vs-button",{attrs:{type:"relief","icon-pack":"feather",icon:"icon-plus-square"},on:{click:function(e){t.is_popup=!0}}},[t._v("បន្ថែម")]),t._v(" "),1===t.selected.length?n("vs-button",{attrs:{color:"warning",type:"relief","icon-pack":"feather",icon:"icon-edit"},on:{click:function(e){t.is_popup_edit=!0,t.$refs.editPopup.editGallery(t.selected[0].id)}}},[t._v("កែប្រែ")]):t._e(),t._v(" "),t.selected.length?n("vs-button",{attrs:{color:"danger",type:"relief","icon-pack":"feather",icon:"icon-trash-2"},on:{click:t.destroyGallery}},[t._v("លុប")]):t._e(),t._v(" "),n("add-gallery",{attrs:{is_popup:t.is_popup},on:{"update-is_popup":t.syncPopup}}),t._v(" "),n("edit-gallery",{ref:"editPopup",attrs:{is_popup:t.is_popup_edit},on:{"update-is_popup":t.syncPopupEdit}})],1),t._v(" "),n("vs-table",{attrs:{multiple:"",pagination:"","max-items":"10",search:"",data:t.all_galleries},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return t._l(a,(function(e,i){return n("vs-tr",{key:i,attrs:{data:e}},[n("vs-td",{attrs:{data:a[i].id}},[t._v("\n                        "+t._s(a[i].id)+"\n                    ")]),t._v(" "),n("vs-td",{attrs:{data:a[i].thumb}},[n("img",{staticClass:"rounded",attrs:{src:a[i].thumb,width:"50",alt:a[i].thumb}})]),t._v(" "),n("vs-td",{attrs:{data:a[i].title}},[t._v("\n                        "+t._s(a[i].title)+"\n                    ")]),t._v(" "),n("vs-td",{attrs:{data:a[i].created_at}},[t._v("\n                        "+t._s(a[i].created_at)+"\n                    ")])],1)}))}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[n("template",{slot:"thead"},[n("vs-th",{attrs:{"sort-key":"id"}},[t._v("ល.រ")]),t._v(" "),n("vs-th",{attrs:{"sort-key":"thumb"}},[t._v("រូប")]),t._v(" "),n("vs-th",{attrs:{"sort-key":"title"}},[t._v("ចំណងជើង")]),t._v(" "),n("vs-th",{attrs:{"sort-key":"created_at"}},[t._v("កាលបរិច្ឆេទ")])],1)],2)],1)],1)}),[],!1,null,null,null));e.default=_.exports},"8nfe":function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".placeholder[data-v-5e227453]{\n  width: 130px;\n  height: 130px;\n  display: -webkit-box;\n  display: flex;\n  -webkit-box-align: center;\n  align-items: center;\n  -webkit-box-pack: center;\n  justify-content: center;\n  color: rgba(0,0,0,.15);\n}[dir] .placeholder[data-v-5e227453]{\n  background: transparent;\n  border-radius: 10px;\n  border: 1px dashed #dcdcdc;\n  cursor: pointer;\n}\n",""])},AyAP:function(t,e,n){var a=n("8nfe");"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(t.exports=a.locals)},fBHZ:function(t,e,n){"use strict";var a=n("g7io");n.n(a).a},g7io:function(t,e,n){var a=n("z6lh");"string"==typeof a&&(a=[[t.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(a,i);a.locals&&(t.exports=a.locals)},sFpq:function(t,e,n){"use strict";var a=n("AyAP");n.n(a).a},xsPV:function(t,e,n){"use strict";var a=n("o0o1"),i=n.n(a),r=n("vDqi"),s=n.n(r);function o(t,e,n,a,i,r,s){try{var o=t[r](s),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(a,i)}var l,c,u={props:["imageSrc","uploadUrl"],name:"ImageUpload",computed:{placeholder:function(){return this.$store.getters.getAppUrl+"images/placeholder/placeholder.png"}},methods:{onFileChange:(l=i.a.mark((function t(e){var n,a,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new FormData,a=e.target.files[0],n.append("file",a),t.next=5,s.a.post(route(this.uploadUrl),n);case 5:r=t.sent,this.$emit("get-image-path",r.data);case 7:case"end":return t.stop()}}),t,this)})),c=function(){var t=this,e=arguments;return new Promise((function(n,a){var i=l.apply(t,e);function r(t){o(i,n,a,r,s,"next",t)}function s(t){o(i,n,a,r,s,"throw",t)}r(void 0)}))},function(t){return c.apply(this,arguments)})}},p=(n("sFpq"),n("KHd+")),d=Object(p.a)(u,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("label",{attrs:{for:"image-upload"}},[e("span",{staticClass:"placeholder"},[this.imageSrc?e("img",{staticClass:"responsive",attrs:{src:this.imageSrc,alt:this.imageSrc}}):this._e()])]),this._v(" "),e("div",{staticClass:"vs-con-input"},[e("input",{staticClass:"hidden",attrs:{type:"file",id:"image-upload",name:"file"},on:{change:this.onFileChange}})])])}),[],!1,null,"5e227453",null);e.a=d.exports},z6lh:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"[dir] #profile-tabs .vs-tabs--content {\n  padding: 0;\n}",""])}}]);