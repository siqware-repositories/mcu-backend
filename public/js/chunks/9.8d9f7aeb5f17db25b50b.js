(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"0WBr":function(t,e,s){"use strict";s.r(e);var i=s("o0o1"),n=s.n(i),a=s("ksP6"),r=s.n(a),o=(s("Hj/Q"),{name:"addGallery",components:{vueDropzone:r.a},props:["is_popup"],data:function(){return{gallery:{thumb:[],title:"",images:[]},upload_url:route("file.upload.thumb"),galleryOptions:{url:route("file.upload.thumb"),thumbnailWidth:150,thumbnailHeight:150,addRemoveLinks:!0,dictDefaultMessage:"ដាក់អាល់ប៊ុមរូបភាព"},thumbnailOptions:{url:route("file.upload.thumb"),maxFiles:1,addRemoveLinks:!0,dictDefaultMessage:"សូមដាក់រូប Thumbnail",thumbnailWidth:150,thumbnailHeight:150}}},computed:{placeholder:function(){return this.$store.getters.getAppUrl+"images/placeholder/placeholder.png"},popupSync:{get:function(){return this.is_popup},set:function(t){this.$emit("update-is_popup",t)}}},methods:{setThumb:function(t){this.gallery.thumb=t},successUploadGallery:function(t,e){this.gallery.images.unshift(e)},successUploadThumb:function(t,e){this.gallery.thumb.unshift(e)},removeGallery:function(t){var e=this.gallery.images.findIndex((function(e){return e.path===JSON.parse(t.xhr.response).path}));this.gallery.images.splice(e,1)},removeThumb:function(t){var e=this.gallery.thumb.findIndex((function(e){return e.path===JSON.parse(t.xhr.response).path}));this.gallery.thumb.splice(e,1)},storeGallery:function(){var t=this,e=this;this.$validator.validateAll().then((function(s){s&&e.gallery.thumb.length&&e.gallery.images.length?(e.$vs.loading(),t.$store.dispatch("storeGallery",e.gallery).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField(),e.$refs.thumb.removeAllFiles(!0),e.$refs.gallery.removeAllFiles(!0)):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.gallery={thumb:[],title:"",images:[]}},removeGallert:function(){}}}),l=s("KHd+"),c=Object(l.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("vs-popup",{attrs:{title:"បន្ថែម",active:t.popupSync},on:{"update:active":function(e){t.popupSync=e}}},[s("div",{staticClass:"vx-row mb-2"},[s("div",{staticClass:"vx-col w-full"},[s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{name:"title","label-placeholder":"ចំណងជើង"},model:{value:t.gallery.title,callback:function(e){t.$set(t.gallery,"title",e)},expression:"gallery.title"}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("title"),expression:"errors.has('title')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("title")))])],1),t._v(" "),s("div",{staticClass:"vx-col w-full mt-2"},[s("vue-dropzone",{ref:"thumb",staticClass:"max-content p-1",attrs:{duplicateCheck:!0,id:"thumbnail",options:t.thumbnailOptions},on:{"vdropzone-removed-file":t.removeThumb,"vdropzone-success":t.successUploadThumb}})],1),t._v(" "),s("vs-divider"),t._v(" "),s("div",{staticClass:"vx-col w-full"},[s("vue-dropzone",{ref:"gallery",staticClass:"p-1",attrs:{duplicateCheck:!0,id:"gallery",options:t.galleryOptions},on:{"vdropzone-removed-file":t.removeGallery,"vdropzone-success":t.successUploadGallery}})],1)],1),t._v(" "),s("vs-divider"),t._v(" "),s("div",{staticClass:"vx-row"},[s("div",{staticClass:"vx-col w-full"},[s("vs-button",{staticClass:"mr-3 mb-2",attrs:{type:"relief"},on:{click:function(e){return e.preventDefault(),t.storeGallery(e)}}},[t._v("\n                រក្សាទុក\n            ")])],1)])],1)}),[],!1,null,"2770bdc2",null).exports;function u(t,e,s,i,n,a,r){try{var o=t[a](r),l=o.value}catch(t){return void s(t)}o.done?e(l):Promise.resolve(l).then(i,n)}var p,d,v={name:"editGallery",props:["is_popup"],data:function(){return{gallery:{id:null,title:""}}},computed:{popupSync:{get:function(){return this.is_popup},set:function(t){this.$emit("update-is_popup",t)}}},methods:{editGallery:function(t){var e=this;e.$store.dispatch("editGallery",t).then((function(t){e.gallery=t}))},updateGallery:function(){var t=this,e=this;this.$validator.validateAll().then((function(s){s?(e.$vs.loading(),t.$store.dispatch("updateGallery",e.gallery).then((function(t){t?(e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.resetField(),e.fetchGallery()):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"ទិន្នន័យមិនបានបន្ថែម",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"}),e.$vs.loading.close()}))):e.$vs.notify({title:"ប្រតិបត្តិការបរាជ័យ",text:"សូមបំពេញទិន្នន័យអោយបានត្រឹមត្រូវ",color:"danger",iconPack:"feather",icon:"icon-message-square",position:"top-center"})}))},resetField:function(){this.gallery={title:""}},fetchGallery:(p=n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("fetchGallery");case 2:case"end":return t.stop()}}),t,this)})),d=function(){var t=this,e=arguments;return new Promise((function(s,i){var n=p.apply(t,e);function a(t){u(n,s,i,a,r,"next",t)}function r(t){u(n,s,i,a,r,"throw",t)}a(void 0)}))},function(){return d.apply(this,arguments)})}};function h(t,e,s,i,n,a,r){try{var o=t[a](r),l=o.value}catch(t){return void s(t)}o.done?e(l):Promise.resolve(l).then(i,n)}function f(t){return function(){var e=this,s=arguments;return new Promise((function(i,n){var a=t.apply(e,s);function r(t){h(a,i,n,r,o,"next",t)}function o(t){h(a,i,n,r,o,"throw",t)}r(void 0)}))}}var m,y,g={name:"Gallery",components:{EditGallery:Object(l.a)(v,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("vs-popup",{attrs:{title:"កែប្រែ",active:t.popupSync},on:{"update:active":function(e){t.popupSync=e}}},[s("div",{staticClass:"vx-row mb-2"},[s("div",{staticClass:"vx-col w-full"},[s("vs-input",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"w-full",attrs:{name:"title","label-placeholder":"ចំណងជើង"},model:{value:t.gallery.title,callback:function(e){t.$set(t.gallery,"title",e)},expression:"gallery.title"}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("title"),expression:"errors.has('title')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("title")))])],1)]),t._v(" "),s("vs-divider"),t._v(" "),s("div",{staticClass:"vx-row"},[s("div",{staticClass:"vx-col w-full"},[s("vs-button",{staticClass:"mr-3 mb-2",attrs:{type:"relief"},on:{click:function(e){return e.preventDefault(),t.updateGallery(e)}}},[t._v("\n                កែប្រែ\n            ")])],1)])],1)}),[],!1,null,"72bc2ea2",null).exports,AddGallery:c},data:function(){return{is_popup:!1,is_popup_edit:!1,selected:[],tableList:["vs-th: Component","vs-tr: Component","vs-td: Component","thread: Slot","tbody: Slot","header: Slot"]}},computed:{all_galleries:function(){return this.$store.getters.all_galleries}},created:(y=f(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchGallery();case 2:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)}),methods:{syncPopup:function(t){this.is_popup=t},syncPopupEdit:function(t){this.is_popup_edit=t,this.selected=[]},fetchGallery:function(){var t=f(n.a.mark((function t(){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("fetchGallery");case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),destroyGallery:(m=f(n.a.mark((function t(){var e,s;return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=this).$vs.loading(),s=e.selected.map(function(){var t=f(n.a.mark((function t(s){return n.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("destroyGallery",s.id);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=5,Promise.all(s).then((function(){e.$vs.notify({time:4e3,title:"ប្រតិបត្តិការជោគជ័យ",text:"ទិន្នន័យបានបន្ថែម",color:"success",iconPack:"feather",icon:"icon-check",position:"top-center"}),e.selected=[],e.$vs.loading.close()}));case 5:case"end":return t.stop()}}),t,this)}))),function(){return m.apply(this,arguments)})}},_=(s("fBHZ"),Object(l.a)(g,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("vx-card",{attrs:{"no-shadow":""}},[s("div",{staticClass:"flex btn-group"},[s("vs-button",{attrs:{type:"relief","icon-pack":"feather",icon:"icon-plus-square"},on:{click:function(e){t.is_popup=!0}}},[t._v("បន្ថែម")]),t._v(" "),1===t.selected.length?s("vs-button",{attrs:{color:"warning",type:"relief","icon-pack":"feather",icon:"icon-edit"},on:{click:function(e){t.is_popup_edit=!0,t.$refs.editPopup.editGallery(t.selected[0].id)}}},[t._v("កែប្រែ")]):t._e(),t._v(" "),t.selected.length?s("vs-button",{attrs:{color:"danger",type:"relief","icon-pack":"feather",icon:"icon-trash-2"},on:{click:t.destroyGallery}},[t._v("លុប")]):t._e(),t._v(" "),s("add-gallery",{attrs:{is_popup:t.is_popup},on:{"update-is_popup":t.syncPopup}}),t._v(" "),s("edit-gallery",{ref:"editPopup",attrs:{is_popup:t.is_popup_edit},on:{"update-is_popup":t.syncPopupEdit}})],1),t._v(" "),s("vs-table",{attrs:{multiple:"",pagination:"","max-items":"10",search:"",data:t.all_galleries},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.data;return t._l(i,(function(e,n){return s("vs-tr",{key:n,attrs:{data:e}},[s("vs-td",{attrs:{data:i[n].id}},[t._v("\n                        "+t._s(i[n].id)+"\n                    ")]),t._v(" "),s("vs-td",{attrs:{data:i[n].thumb}},[s("img",{staticClass:"rounded",attrs:{src:i[n].thumb,width:"50",alt:i[n].thumb}})]),t._v(" "),s("vs-td",{attrs:{data:i[n].title}},[t._v("\n                        "+t._s(i[n].title)+"\n                    ")]),t._v(" "),s("vs-td",{attrs:{data:i[n].created_at}},[t._v("\n                        "+t._s(i[n].created_at)+"\n                    ")])],1)}))}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[s("template",{slot:"thead"},[s("vs-th",{attrs:{"sort-key":"id"}},[t._v("ល.រ")]),t._v(" "),s("vs-th",{attrs:{"sort-key":"thumb"}},[t._v("រូប")]),t._v(" "),s("vs-th",{attrs:{"sort-key":"title"}},[t._v("ចំណងជើង")]),t._v(" "),s("vs-th",{attrs:{"sort-key":"created_at"}},[t._v("កាលបរិច្ឆេទ")])],1)],2)],1)],1)}),[],!1,null,null,null));e.default=_.exports},fBHZ:function(t,e,s){"use strict";var i=s("g7io");s.n(i).a},g7io:function(t,e,s){var i=s("z6lh");"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};s("aET+")(i,n);i.locals&&(t.exports=i.locals)},z6lh:function(t,e,s){(t.exports=s("I1BE")(!1)).push([t.i,"[dir] #profile-tabs .vs-tabs--content {\n  padding: 0;\n}",""])}}]);